{# TABLE RELATIONSHIPS - SHARED COMPONENT #}
{# This component defines the database table relationships #}

TABLE RELATIONSHIPS:
- dev.segmentacion (FACT TABLE)
  ├── dev.cliente (DIMENSION - customer_id) [1:M]
  ├── dev.producto (DIMENSION - material_id->Material) [1:M] 
  └── dev.tiempo (DIMENSION - calday->Fecha) [1:M]
- dev.cliente_cedi (BRIDGE TABLE)
  ├── dev.cliente (customer_id) [M:1]
  └── dev.mercado (CEDIid->cedi_id) [M:1]

RELATIONSHIP DETAILS:
- dev.segmentacion (FACT) connects to:
  - dev.cliente via customer_id
  - dev.producto via material_id -> Material
  - dev.tiempo via calday -> Fecha
- dev.cliente_cedi bridges dev.cliente and dev.mercado
- dev.mercado connects via CEDIid -> cedi_id

TIME PERIOD RELATIONSHIPS:
- For quarterly analysis requiring "last quarter" data:
  1. Create LastQuarter CTE: SELECT TOP 1 Year, Q FROM dev.tiempo ORDER BY Year DESC, Q DESC
  2. Use CROSS JOIN LastQuarter lq with main data tables
  3. Apply time filtering: WHERE t.Year = lq.Year AND t.Q = lq.Q
  4. This approach ensures accurate time filtering and reliable data retrieval
